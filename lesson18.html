<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        // try {
        //     const amazon = fetch('https://amazon.com')
        //     if (!amazon.response) throw 'Request has been blocked by CORS policy'
        // } catch(err) {
        //     console.log('CORS error. Your request was blocked by the backend\n' + err)
        // }
        
        async function use() {
            const xhr = await new XMLHttpRequest()
            await xhr.open('GET', 'https://supersimplebackend.dev/greeting') 
            await xhr.send()
            xhr.addEventListener('load', ()=>{
                console.log(xhr.response)
            });
        }
        use()

        async function use2() {
            const response = await fetch('https://supersimplebackend.dev/greeting')
            const data = await response.text()
            console.log(data)
        }
        use2()

        async function use3() {
            const response = await fetch('https://supersimplebackend.dev/greeting', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({name: 'Red'})
            });
            const data = await response.text()
            console.log(data)
        }
        use3()

        async function use4() {
            try {
                const response = await fetch('https://supersimplebackend.dev/greeting', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                if (response.status >= 400) throw await response
                const data = await response.text()
                console.log(data)
            }
            catch(err) {
                if (await err.status === 400) {
                    err = await err.json() 
                    console.log(await err.errorMessage)
                }
                else {console.log('Network error. Please try again later.')}
            }
        }
        use4()
        
        const xhr = new XMLHttpRequest()
        xhr.open('GET', 'https://supersimplebackend.dev/greeting')
        xhr.send()
        xhr.addEventListener('load', ()=>{
            console.log(xhr.response)
        });
    </script>
</body>
</html>